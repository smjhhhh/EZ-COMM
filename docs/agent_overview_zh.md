# 代理概览（中文）

本仓库汇集了一组围绕旅行规划的 AI Agent，每个模块各司其职，通过
结构化 JSON 互相传递信息，方便在编排流程中组合或替换。

## 模块说明

### `final.py` —— 行程合并代理
- 接收多个候选行程节点和用户偏好上下文。
- 负责整理 LLM 提示载荷并委派外部模型（如 Gemini）生成最终统一行程。
- 返回提示、原始 LLM 响应以及合并后的行程，便于下游消费。

### `imagesearch.py` —— 图片识别景点代理
- 先调用 Gemini 多模态识别照片中的地标，若失败则回退到本地视觉、OCR
  与网络搜索。
- 聚合 Places API 结果、网页摘要和叙述性提示，输出候选 POI 及最佳匹配。
- 提供统一的 JSON 输出结构，方便前端或 API 直接使用。

### `information.py` —— 信息汇聚代理
- 接收天气、搜索、地图、RAG 等子代理返回的数据。
- 统一封装为带会话元信息的 JSON，便于注入提示或持久化。

### `plan.py` —— 单景点提示代理
- 配置轻量 LLM 调用参数，用于生成单个景点的游玩计划。
- 构建严格的 JSON-only 提示、调用（占位）LLM，并校验输出可解析为 JSON。

### `rag.py` 与 `userchoice.py` —— 请求规范化代理
- 采用 ADK 风格模板，结合原始用户文本与选项，调用 Gemini 推断意图与约束，
  输出统一的需求规格。
- 内置用户偏好默认值和溯源信息，保证后续代理共享一致的数据契约。

### `weightadjustment.py` —— 权重调整代理
- 将用户评分与当前组件权重发给 Gemini，请求在约束条件下给出新的全局/
  用户权重。
- 打包返回的策略结果及提示载荷，方便审核和回放。

## 推荐流程
1. 先对用户需求做规范化处理（`rag.py` 或 `userchoice.py`）。
2. 汇总事实信息（RAG、搜索、天气等），再统一封装（`information.py`）。
3. 生成或合并行程（单景点用 `plan.py`，多日行程用 `final.py`）。
4. 根据反馈调整权重（`weightadjustment.py`）。
5. 需要时通过照片直接识别景点（`imagesearch.py`）。

所有模块均为脚手架代码，在标记的 TODO 位置可以接入真实的 API 调用和
业务逻辑。

